<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Resume ATS Scanner - Indigibilli Harshit Team</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }

        /* Watermark Styles */
        .watermark {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px 0;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #6366f1;
            letter-spacing: 1px;
            text-transform: uppercase;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .watermark.bottom {
            position: sticky;
            bottom: 0;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            border-bottom: none;
            margin-top: auto;
        }

        .watermark i {
            margin: 0 8px;
            color: #f59e0b;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.12),
                0 0 0 1px rgba(255, 255, 255, 0.05);
            overflow: hidden;
            margin-top: 20px;
            margin-bottom: 20px;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            color: white;
            padding: 48px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #ffffff 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.25rem;
            opacity: 0.9;
            font-weight: 400;
            margin-bottom: 24px;
            color: #cbd5e1;
        }

        .header .features {
            display: flex;
            justify-content: center;
            gap: 32px;
            flex-wrap: wrap;
            margin-top: 32px;
        }

        .feature-badge {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .main-content {
            padding: 48px 40px;
            background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
        }

        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .input-group {
            background: #ffffff;
            border-radius: 20px;
            padding: 32px;
            border: 1px solid #e2e8f0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .input-group::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #6366f1, #8b5cf6, #ec4899);
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .input-group:hover::before {
            transform: scaleX(1);
        }

        .input-group:hover {
            transform: translateY(-8px);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(99, 102, 241, 0.1);
            border-color: #c7d2fe;
        }

        .input-group h3 {
            color: #1e293b;
            margin-bottom: 24px;
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .input-group h3 i {
            font-size: 1.25rem;
            color: #6366f1;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #ffffff;
        }

        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            transform: translateY(-2px);
        }

        textarea {
            resize: vertical;
            min-height: 140px;
            line-height: 1.6;
        }

        .file-upload {
            position: relative;
            display: block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 32px 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px dashed #cbd5e1;
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 120px;
        }

        .file-upload-label:hover {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            border-color: #6366f1;
            transform: translateY(-2px);
        }

        .file-upload-label i {
            font-size: 2rem;
            color: #6366f1;
            margin-bottom: 12px;
        }

        .file-upload-label .upload-text {
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }

        .file-upload-label .upload-subtext {
            font-size: 14px;
            color: #6b7280;
        }

        .uploaded-files {
            margin-top: 16px;
            max-height: 200px;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            background: #f1f5f9;
            border-color: #6366f1;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .file-info i {
            color: #6366f1;
        }

        .file-name {
            font-weight: 500;
            color: #374151;
        }

        .file-size {
            font-size: 12px;
            color: #6b7280;
        }

        .remove-file {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .remove-file:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        .analyze-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
            color: white;
            border: none;
            padding: 20px 48px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 40px auto;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
            position: relative;
            overflow: hidden;
        }

        .analyze-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .analyze-btn:hover::before {
            left: 100%;
        }

        .analyze-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 48px rgba(99, 102, 241, 0.4);
        }

        .analyze-btn:disabled {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .analyze-btn i {
            font-size: 1.25rem;
        }

        .results {
            margin-top: 48px;
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-header {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 24px;
            padding: 32px;
            text-align: center;
            margin-bottom: 32px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }

        .results-title {
            font-size: 2rem;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        .results-subtitle {
            color: #6b7280;
            font-size: 1.1rem;
        }

        .candidates-grid {
            display: grid;
            gap: 24px;
            margin-bottom: 32px;
        }

        .candidate-card {
            background: #ffffff;
            border-radius: 20px;
            padding: 32px;
            border: 1px solid #e2e8f0;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .candidate-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--rank-color), var(--rank-color-light));
        }

        .candidate-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        }

        .candidate-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .candidate-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .rank-badge {
            background: var(--rank-color);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 800;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .candidate-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
        }

        .score-display {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .score-circle-small {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(
                var(--rank-color) 0deg, 
                var(--rank-color) calc(var(--score) * 3.6deg), 
                #f3f4f6 calc(var(--score) * 3.6deg)
            );
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .score-circle-small::before {
            content: '';
            width: 60px;
            height: 60px;
            background: #ffffff;
            border-radius: 50%;
            position: absolute;
        }

        .score-text-small {
            position: relative;
            font-size: 1rem;
            font-weight: 800;
            color: #1e293b;
            z-index: 2;
        }

        .score-label {
            font-size: 0.875rem;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .candidate-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .detail-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .detail-card h5 {
            color: #374151;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-card h5 i {
            color: #6366f1;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .skill-tag {
            background: #e0e7ff;
            color: #3730a3;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 500;
        }

        .keyword-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .keyword-item {
            background: #fef3c7;
            color: #92400e;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ffffff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: var(--rank-color);
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        .comparison-section {
            background: #ffffff;
            border-radius: 20px;
            padding: 32px;
            border: 1px solid #e2e8f0;
            margin-top: 32px;
        }

        .comparison-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .comparison-chart {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
        }

        .chart-item {
            text-align: center;
        }

        .chart-label {
            font-weight: 600;
            color: #374151;
            margin-bottom: 12px;
        }

        .chart-bar {
            height: 200px;
            background: #f8fafc;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }

        .chart-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, #6366f1, #8b5cf6);
            border-radius: 8px 8px 0 0;
            transition: height 1s ease;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 8px;
            color: white;
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .container {
                margin: 10px;
                border-radius: 16px;
            }
            
            .main-content {
                padding: 32px 24px;
            }
            
            .header {
                padding: 32px 24px;
            }
        }

        @media (max-width: 768px) {
            .input-section {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .header .features {
                gap: 16px;
            }

            .feature-badge {
                font-size: 12px;
                padding: 6px 12px;
            }

            .input-group {
                padding: 24px;
            }

            .candidate-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .score-display {
                align-self: flex-end;
            }

            .candidate-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Top Watermark -->
    <div class="watermark">
        <i class="fas fa-crown"></i>
        Powered by Indigibilli Harshit Team - Advanced Multi-Resume ATS Technology
        <i class="fas fa-crown"></i>
    </div>

    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1><i class="fas fa-users"></i> Multi-Resume ATS Scanner</h1>
                <p class="subtitle">Compare Multiple Candidates Against Job Requirements with AI-Powered Analysis</p>
                <div class="features">
                    <div class="feature-badge">
                        <i class="fas fa-layer-group"></i> Bulk Processing
                    </div>
                    <div class="feature-badge">
                        <i class="fas fa-sort-amount-down"></i> Smart Ranking
                    </div>
                    <div class="feature-badge">
                        <i class="fas fa-chart-bar"></i> Comparative Analysis
                    </div>
                    <div class="feature-badge">
                        <i class="fas fa-lightning-bolt"></i> Instant Results
                    </div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="input-section">
                <div class="input-group">
                    <h3><i class="fas fa-briefcase"></i> Job Requirements</h3>
                    <div class="form-group">
                        <label for="jobTitle">
                            <i class="fas fa-tag"></i> Job Title
                        </label>
                        <input type="text" id="jobTitle" placeholder="e.g., Senior Software Engineer, Data Scientist, Product Manager">
                    </div>
                    <div class="form-group">
                        <label for="jobDescription">
                            <i class="fas fa-file-alt"></i> Complete Job Description
                        </label>
                        <textarea id="jobDescription" placeholder="Paste the complete job description including requirements, responsibilities, skills, qualifications, and experience needed..."></textarea>
                    </div>
                </div>

                <div class="input-group">
                    <h3><i class="fas fa-users"></i> Multiple Resume Upload</h3>
                    <div class="form-group">
                        <label>
                            <i class="fas fa-cloud-upload-alt"></i> Upload Multiple Resume Files
                        </label>
                        <div class="file-upload">
                            <input type="file" id="resumeFiles" accept=".pdf,.doc,.docx,.txt" multiple>
                            <label for="resumeFiles" class="file-upload-label">
                                <i class="fas fa-file-upload"></i>
                                <div class="upload-text">Drop multiple resumes here or click to browse</div>
                                <div class="upload-subtext">Supports PDF, Word, and Text files (Multiple selection)</div>
                            </label>
                        </div>
                        <div class="uploaded-files" id="uploadedFiles"></div>
                    </div>
                </div>
            </div>

            <button class="analyze-btn" onclick="analyzeMultipleResumes()">
                <i class="fas fa-search"></i>
                <span>Analyze & Rank All Resumes</span>
            </button>

            <div class="results" id="results">
                <div class="results-header">
                    <h2 class="results-title">
                        <i class="fas fa-trophy"></i>
                        Candidate Ranking Results
                    </h2>
                    <p class="results-subtitle">
                        Resumes ranked by ATS compatibility score - Best matches first
                    </p>
                </div>

                <div class="candidates-grid" id="candidatesGrid">
                    <!-- Candidate results will be populated here -->
                </div>

                <div class="comparison-section">
                    <h3 class="comparison-title">
                        <i class="fas fa-chart-line"></i>
                        Comparative Analysis
                    </h3>
                    <div class="comparison-chart" id="comparisonChart">
                        <!-- Comparison charts will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Watermark -->
    <div class="watermark bottom">
        <i class="fas fa-code"></i>
        Â© 2024 Indigibilli Harshit Team - Professional Multi-Resume Analysis Solutions
        <i class="fas fa-code"></i>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <script>
        // Set PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        let uploadedResumes = [];

        // File parsing functions
        async function parsePDF(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                let text = '';
                
                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const content = await page.getTextContent();
                    const pageText = content.items.map(item => item.str).join(' ');
                    text += pageText + ' ';
                }
                
                return text.trim();
            } catch (error) {
                throw new Error(`Failed to parse PDF file: ${file.name}`);
            }
        }

        async function parseDocx(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                const result = await mammoth.extractRawText({ arrayBuffer });
                return result.value;
            } catch (error) {
                throw new Error(`Failed to parse Word document: ${file.name}`);
            }
        }

        async function parseTextFile(file) {
            try {
                return await file.text();
            } catch (error) {
                throw new Error(`Failed to read text file: ${file.name}`);
            }
        }

        // Enhanced NLP Processing Functions
        function preprocessText(text) {
            return text.toLowerCase()
                      .replace(/[^\w\s]/g, ' ')
                      .replace(/\s+/g, ' ')
                      .trim();
        }

        function extractKeywords(text) {
            const stopWords = new Set([
                'the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by',
                'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'do', 'does', 'did',
                'will', 'would', 'could', 'should', 'may', 'might', 'can', 'must', 'shall', 'this', 'that',
                'these', 'those', 'i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', 'your',
                'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', 'her', 'hers',
                'herself', 'it', 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves'
            ]);

            const words = preprocessText(text).split(' ');
            const keywords = words.filter(word => 
                word.length > 2 && 
                !stopWords.has(word) && 
                !/^\d+$/.test(word)
            );

            const frequency = {};
            keywords.forEach(word => {
                frequency[word] = (frequency[word] || 0) + 1;
            });

            return Object.keys(frequency).sort((a, b) => frequency[b] - frequency[a]);
        }

        function extractSkills(text) {
            const skillCategories = {
                programming: [
                    'javascript', 'python', 'java', 'typescript', 'c++', 'c#', 'php', 'ruby', 'go', 'golang',
                    'rust', 'swift', 'kotlin', 'scala', 'r', 'matlab', 'perl', 'shell', 'bash', 'powershell'
                ],
                frameworks: [
                    'react', 'angular', 'vue', 'nodejs', 'express', 'django', 'flask', 'spring', 'laravel',
                    'rails', 'asp.net', 'jquery', 'bootstrap', 'tailwind', 'nextjs', 'nuxtjs', 'gatsby'
                ],
                databases: [
                    'sql', 'mysql', 'postgresql', 'mongodb', 'redis', 'elasticsearch', 'oracle', 'sqlite',
                    'cassandra', 'dynamodb', 'firebase', 'supabase'
                ],
                cloud: [
                    'aws', 'azure', 'gcp', 'google cloud', 'docker', 'kubernetes', 'jenkins', 'terraform',
                    'ansible', 'chef', 'puppet', 'vagrant', 'heroku', 'vercel', 'netlify'
                ],
                tools: [
                    'git', 'github', 'gitlab', 'bitbucket', 'jira', 'confluence', 'slack', 'trello',
                    'asana', 'notion', 'figma', 'sketch', 'adobe', 'photoshop', 'illustrator'
                ],
                methodologies: [
                    'agile', 'scrum', 'kanban', 'devops', 'ci/cd', 'tdd', 'bdd', 'microservices',
                    'rest', 'graphql', 'api', 'mvc', 'mvp', 'solid'
                ],
                soft: [
                    'leadership', 'management', 'communication', 'teamwork', 'problem solving',
                    'analytical', 'creative', 'innovative', 'collaborative', 'adaptable'
                ],
                data: [
                    'machine learning', 'deep learning', 'ai', 'data science', 'analytics', 'statistics',
                    'tableau', 'powerbi', 'excel', 'pandas', 'numpy', 'tensorflow', 'pytorch', 'scikit-learn'
                ]
            };

            const textLower = text.toLowerCase();
            const foundSkills = [];

            Object.entries(skillCategories).forEach(([category, skills]) => {
                skills.forEach(skill => {
                    if (textLower.includes(skill.toLowerCase())) {
                        foundSkills.push(skill);
                    }
                });
            });

            return foundSkills;
        }

        function extractExperience(text) {
            const experiencePatterns = [
                /(\d+)[\+\s]*years?\s*of\s*experience/gi,
                /(\d+)[\+\s]*years?\s*experience/gi,
                /experience.*?(\d+)[\+\s]*years?/gi,
                /(\d+)[\+\s]*yrs/gi,
                /(\d+)[\+\s]*year/gi
            ];

            const experiences = [];
            experiencePatterns.forEach(pattern => {
                const matches = text.match(pattern);
                if (matches) {
                    matches.forEach(match => {
                        const years = match.match(/\d+/);
                        if (years) {
                            experiences.push(parseInt(years[0]));
                        }
                    });
                }
            });

            return experiences.length > 0 ? Math.max(...experiences) : 0;
        }

        function extractEducation(text) {
            const educationLevels = {
                'phd': 5, 'doctorate': 5, 'doctoral': 5,
                'master': 4, 'masters': 4, 'mba': 4, 'ms': 4, 'ma': 4,
                'bachelor': 3, 'bachelors': 3, 'bs': 3, 'ba': 3, 'be': 3,
                'associate': 2, 'diploma': 2,
                'certificate': 1, 'certification': 1
            };

            const textLower = text.toLowerCase();
            const foundEducation = [];
            let highestLevel = 0;

            Object.entries(educationLevels).forEach(([degree, level]) => {
                if (textLower.includes(degree)) {
                    foundEducation.push(degree);
                    highestLevel = Math.max(highestLevel, level);
                }
            });

            return { degrees: foundEducation, level: highestLevel };
        }

        function calculateATSScore(jobData, resumeData) {
            const weights = {
                skills: 0.35,
                keywords: 0.25,
                experience: 0.20,
                education: 0.20
            };

            // Skills matching
            const jobSkills = jobData.skills;
            const resumeSkills = resumeData.skills;
            const skillMatches = jobSkills.filter(skill =>
                resumeSkills.some(rSkill => 
                    rSkill.toLowerCase().includes(skill.toLowerCase()) ||
                    skill.toLowerCase().includes(rSkill.toLowerCase())
                )
            );
            const skillsScore = jobSkills.length > 0 ? (skillMatches.length / jobSkills.length) * 100 : 50;

            // Keywords matching
            const jobKeywords = jobData.keywords.slice(0, 25);
            const resumeKeywords = resumeData.keywords;
            const keywordMatches = jobKeywords.filter(keyword =>
                resumeKeywords.includes(keyword)
            );
            const keywordScore = jobKeywords.length > 0 ? (keywordMatches.length / jobKeywords.length) * 100 : 50;

            // Experience matching
            const experienceScore = resumeData.experience >= jobData.experience ? 100 :
                                  jobData.experience > 0 ? (resumeData.experience / jobData.experience) * 100 : 70;

            // Education matching
            const educationScore = resumeData.education.level >= jobData.education.level ? 100 :
                                 jobData.education.level > 0 ? (resumeData.education.level / jobData.education.level) * 100 : 70;

            const totalScore = (skillsScore * weights.skills) +
                             (keywordScore * weights.keywords) +
                             (experienceScore * weights.experience) +
                             (educationScore * weights.education);

            return {
                total: Math.round(Math.min(totalScore, 100)),
                breakdown: {
                    skills: Math.round(skillsScore),
                    keywords: Math.round(keywordScore),
                    experience: Math.round(experienceScore),
                    education: Math.round(educationScore)
                },
                matches: {
                    skills: skillMatches,
                    keywords: keywordMatches
                }
            };
        }

        async function analyzeMultipleResumes() {
            const jobTitle = document.getElementById('jobTitle').value.trim();
            const jobDescription = document.getElementById('jobDescription').value.trim();

            if (!jobTitle || !jobDescription) {
                showNotification('Please enter both job title and description', 'error');
                return;
            }

            if (uploadedResumes.length === 0) {
                showNotification('Please upload at least one resume file', 'error');
                return;
            }

            const analyzeBtn = document.querySelector('.analyze-btn');
            const originalBtnContent = analyzeBtn.innerHTML;

            try {
                analyzeBtn.innerHTML = '<div class="loading-spinner"></div><span>Processing Resumes...</span>';
                analyzeBtn.disabled = true;

                // Process job description
                const jobData = {
                    title: jobTitle,
                    keywords: extractKeywords(jobDescription),
                    skills: extractSkills(jobDescription),
                    experience: extractExperience(jobDescription),
                    education: extractEducation(jobDescription)
                };

                const candidateResults = [];

                // Process each resume
                for (let i = 0; i < uploadedResumes.length; i++) {
                    const resume = uploadedResumes[i];
                    
                    analyzeBtn.innerHTML = `<div class="loading-spinner"></div><span>Processing ${resume.name} (${i + 1}/${uploadedResumes.length})</span>`;

                    try {
                        let resumeContent = '';
                        const fileType = resume.file.type;
                        const fileName = resume.file.name.toLowerCase();

                        if (fileType === 'application/pdf' || fileName.endsWith('.pdf')) {
                            resumeContent = await parsePDF(resume.file);
                        } else if (fileType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ||
                                   fileType === 'application/msword' ||
                                   fileName.endsWith('.docx') || fileName.endsWith('.doc')) {
                            resumeContent = await parseDocx(resume.file);
                        } else if (fileType === 'text/plain' || fileName.endsWith('.txt')) {
                            resumeContent = await parseTextFile(resume.file);
                        }

                        // Process resume
                        const resumeData = {
                            keywords: extractKeywords(resumeContent),
                            skills: extractSkills(resumeContent),
                            experience: extractExperience(resumeContent),
                            education: extractEducation(resumeContent)
                        };

                        // Calculate ATS score
                        const atsAnalysis = calculateATSScore(jobData, resumeData);

                        candidateResults.push({
                            name: resume.name,
                            fileName: resume.file.name,
                            analysis: atsAnalysis,
                            resumeData: resumeData
                        });

                    } catch (error) {
                        candidateResults.push({
                            name: resume.name,
                            fileName: resume.file.name,
                            error: error.message,
                            analysis: { total: 0, breakdown: {}, matches: {} },
                            resumeData: { skills: [], keywords: [], experience: 0, education: { level: 0 } }
                        });
                    }
                }

                // Sort by ATS score (highest first)
                candidateResults.sort((a, b) => b.analysis.total - a.analysis.total);

                // Display results
                displayMultipleResults(candidateResults, jobData);

                analyzeBtn.innerHTML = originalBtnContent;
                analyzeBtn.disabled = false;

            } catch (error) {
                analyzeBtn.innerHTML = originalBtnContent;
                analyzeBtn.disabled = false;
                showNotification(error.message, 'error');
            }
        }

        function displayMultipleResults(candidates, jobData) {
            const resultsDiv = document.getElementById('results');
            const candidatesGrid = document.getElementById('candidatesGrid');
            const comparisonChart = document.getElementById('comparisonChart');

            // Clear previous results
            candidatesGrid.innerHTML = '';
            comparisonChart.innerHTML = '';

            // Generate candidate cards
            candidates.forEach((candidate, index) => {
                const rank = index + 1;
                const rankColors = [
                    { color: '#ffd700', light: '#fff9c4' }, // Gold
                    { color: '#c0c0c0', light: '#f3f4f6' }, // Silver
                    { color: '#cd7f32', light: '#fef3c7' }, // Bronze
                    { color: '#6366f1', light: '#e0e7ff' }, // Default
                ];
                
                const colorIndex = Math.min(rank - 1, 3);
                const rankColor = rankColors[colorIndex];

                const candidateCard = document.createElement('div');
                candidateCard.className = 'candidate-card';
                candidateCard.style.setProperty('--rank-color', rankColor.color);
                candidateCard.style.setProperty('--rank-color-light', rankColor.light);
                candidateCard.style.setProperty('--score', candidate.analysis.total);

                candidateCard.innerHTML = `
                    <div class="candidate-header">
                        <div class="candidate-info">
                            <div class="rank-badge">${rank}</div>
                            <div>
                                <div class="candidate-name">${candidate.name}</div>
                                <div style="color: #6b7280; font-size: 0.875rem;">${candidate.fileName}</div>
                            </div>
                        </div>
                        <div class="score-display">
                            <div>
                                <div class="score-label">ATS Score</div>
                                <div class="score-circle-small">
                                    <span class="score-text-small">${candidate.analysis.total}%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    ${candidate.error ? `
                        <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 16px; color: #dc2626;">
                            <i class="fas fa-exclamation-triangle"></i> Error: ${candidate.error}
                        </div>
                    ` : `
                        <div class="candidate-details">
                            <div class="detail-card">
                                <h5><i class="fas fa-chart-bar"></i> Score Breakdown</h5>
                                <div style="margin-bottom: 8px;">Skills: ${candidate.analysis.breakdown.skills || 0}%</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${candidate.analysis.breakdown.skills || 0}%"></div>
                                </div>
                                <div style="margin: 8px 0;">Keywords: ${candidate.analysis.breakdown.keywords || 0}%</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${candidate.analysis.breakdown.keywords || 0}%"></div>
                                </div>
                                <div style="margin: 8px 0;">Experience: ${candidate.analysis.breakdown.experience || 0}%</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${candidate.analysis.breakdown.experience || 0}%"></div>
                                </div>
                            </div>

                            <div class="detail-card">
                                <h5><i class="fas fa-check-circle"></i> Matched Skills</h5>
                                <div class="skill-tags">
                                    ${(candidate.analysis.matches.skills || []).slice(0, 6).map(skill => 
                                        `<span class="skill-tag">${skill}</span>`
                                    ).join('')}
                                    ${(candidate.analysis.matches.skills || []).length > 6 ? 
                                        `<span class="skill-tag">+${(candidate.analysis.matches.skills || []).length - 6} more</span>` : ''}
                                </div>
                            </div>

                            <div class="detail-card">
                                <h5><i class="fas fa-key"></i> Key Info</h5>
                                <div style="margin-bottom: 8px;">
                                    <strong>Experience:</strong> ${candidate.resumeData.experience} years
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <strong>Skills Found:</strong> ${candidate.resumeData.skills.length}
                                </div>
                                <div>
                                    <strong>Keywords Matched:</strong> ${(candidate.analysis.matches.keywords || []).length}
                                </div>
                            </div>

                            <div class="detail-card">
                                <h5><i class="fas fa-lightbulb"></i> Top Keywords</h5>
                                <div class="keyword-list">
                                    ${(candidate.analysis.matches.keywords || []).slice(0, 8).map(keyword => 
                                        `<span class="keyword-item">${keyword}</span>`
                                    ).join('')}
                                </div>
                            </div>
                        </div>
                    `}
                `;

                candidatesGrid.appendChild(candidateCard);
            });

            // Generate comparison chart
            const categories = ['Skills', 'Keywords', 'Experience', 'Education'];
            categories.forEach(category => {
                const chartItem = document.createElement('div');
                chartItem.className = 'chart-item';
                
                const maxScore = Math.max(...candidates.map(c => c.analysis.breakdown[category.toLowerCase()] || 0));
                
                chartItem.innerHTML = `
                    <div class="chart-label">${category} Comparison</div>
                    <div class="chart-bar">
                        ${candidates.slice(0, 5).map((candidate, index) => {
                            const score = candidate.analysis.breakdown[category.toLowerCase()] || 0;
                            const height = maxScore > 0 ? (score / maxScore) * 100 : 0;
                            return `
                                <div class="chart-fill" style="height: ${height}%; background: linear-gradient(180deg, ${
                                    index === 0 ? '#ffd700' : 
                                    index === 1 ? '#c0c0c0' : 
                                    index === 2 ? '#cd7f32' : '#6366f1'
                                }, ${
                                    index === 0 ? '#ffed4e' : 
                                    index === 1 ? '#e5e7eb' : 
                                    index === 2 ? '#f59e0b' : '#8b5cf6'
                                });">
                                    ${score}%
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                
                comparisonChart.appendChild(chartItem);
            });

            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 16px 24px;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                animation: slideInRight 0.3s ease-out;
                max-width: 400px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            `;

            if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                notification.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${message}`;
            } else {
                notification.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                notification.innerHTML = `<i class="fas fa-info-circle"></i> ${message}`;
            }

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 5000);
        }

        // File upload handling
        document.getElementById('resumeFiles').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const uploadedFilesDiv = document.getElementById('uploadedFiles');

            files.forEach(file => {
                const fileSize = (file.size / 1024 / 1024).toFixed(2);
                const fileName = file.name.replace(/\.[^/.]+$/, ""); // Remove extension for display name
                
                const resumeData = {
                    name: fileName,
                    file: file,
                    size: fileSize
                };

                uploadedResumes.push(resumeData);

                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <i class="fas fa-file-alt"></i>
                        <div>
                            <div class="file-name">${fileName}</div>
                            <div class="file-size">${fileSize} MB</div>
                        </div>
                    </div>
                    <button class="remove-file" onclick="removeFile(${uploadedResumes.length - 1})">
                        <i class="fas fa-times"></i>
                    </button>
                `;

                uploadedFilesDiv.appendChild(fileItem);
            });

            // Update upload label
            const label = document.querySelector('.file-upload-label');
            if (uploadedResumes.length > 0) {
                label.innerHTML = `
                    <i class="fas fa-check-circle" style="color: #10b981;"></i>
                    <div class="upload-text" style="color: #10b981;">${uploadedResumes.length} Resume(s) Uploaded</div>
                    <div class="upload-subtext">Click to add more resumes</div>
                `;
                label.style.background = 'linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)';
                label.style.borderColor = '#10b981';
            }

            // Clear the input
            e.target.value = '';
        });

        function removeFile(index) {
            uploadedResumes.splice(index, 1);
            updateFileDisplay();
        }

        function updateFileDisplay() {
            const uploadedFilesDiv = document.getElementById('uploadedFiles');
            uploadedFilesDiv.innerHTML = '';

            uploadedResumes.forEach((resume, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <i class="fas fa-file-alt"></i>
                        <div>
                            <div class="file-name">${resume.name}</div>
                            <div class="file-size">${resume.size} MB</div>
                        </div>
                    </div>
                    <button class="remove-file" onclick="removeFile(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                uploadedFilesDiv.appendChild(fileItem);
            });

            // Update upload label
            const label = document.querySelector('.file-upload-label');
            if (uploadedResumes.length === 0) {
                label.innerHTML = `
                    <i class="fas fa-file-upload"></i>
                    <div class="upload-text">Drop multiple resumes here or click to browse</div>
                    <div class="upload-subtext">Supports PDF, Word, and Text files (Multiple selection)</div>
                `;
                label.style.background = 'linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)';
                label.style.borderColor = '#cbd5e1';
            } else {
                label.innerHTML = `
                    <i class="fas fa-check-circle" style="color: #10b981;"></i>
                    <div class="upload-text" style="color: #10b981;">${uploadedResumes.length} Resume(s) Uploaded</div>
                    <div class="upload-subtext">Click to add more resumes</div>
                `;
                label.style.background = 'linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)';
                label.style.borderColor = '#10b981';
            }
        }

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>